<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:svg="clr-namespace:Avalonia.Svg.Skia;assembly=Avalonia.Svg.Skia"
        mc:Ignorable="d"
        x:Class="SignatureGenerator.MainWindow"
        Title="Email Signature Generator"
        Width="1280" Height="760"
        MinWidth="1180" MinHeight="680"
        WindowStartupLocation="CenterScreen">

  <!-- ðŸŒ¿ Global styles -->
  <Window.Styles>
    <Style Selector="Button">
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="HorizontalContentAlignment" Value="Center"/>
      <Setter Property="Padding" Value="16,10"/>
      <Setter Property="MinHeight" Value="38"/>
    </Style>

    <Style Selector="Button.primary">
      <Setter Property="Padding" Value="20,12"/>
      <Setter Property="MinHeight" Value="42"/>
    </Style>

    <Style Selector="Button.outline">
      <Setter Property="Padding" Value="16,8"/>
      <Setter Property="MinHeight" Value="34"/>
    </Style>
  </Window.Styles>

  <Grid Background="{DynamicResource PrimaryBackground}">
    <Grid Margin="22" ColumnDefinitions="560,*" ColumnSpacing="26">

      <!-- LEFT COLUMN -->
      <Grid RowDefinitions="Auto,16,Auto,16,Auto,16,*">

        <!-- Logo + Title/Sub -->
        <Border Classes="card" Padding="18" BorderThickness="0" Background="{DynamicResource PrimaryBackground}">
            <StackPanel Spacing="4">
              <TextBlock Classes="h1" Text="Email Signature Generator"/>
              <TextBlock Classes="subtitle"
                         Text="Upload an HTML and CSV file, generate signatures, and send them by email."/>
            </StackPanel>
        </Border>

        <!-- Uploads -->
        <Grid Grid.Row="2" ColumnDefinitions="*,*" ColumnSpacing="22">
          <!-- HTML -->
          <Border Classes="card" Padding="18" Grid.Column="0">
            <StackPanel Spacing="12">
              <TextBlock Text="Upload HTML Template" FontWeight="SemiBold"/>
              <TextBlock x:Name="TxtHtmlPath" Classes="muted"
                         Text="No file selected" TextWrapping="Wrap"/>
              <Button x:Name="BtnChooseHtml"
                      Classes="outline" Content="Chooseâ€¦"
                      Width="160"
                      HorizontalAlignment="Left"
                      Click="BtnChooseHtml_OnClick"/>
            </StackPanel>
          </Border>

          <!-- CSV -->
          <Border Classes="card" Padding="18" Grid.Column="1">
            <StackPanel Spacing="12">
              <TextBlock Text="Upload CSV Data" FontWeight="SemiBold"/>
              <TextBlock x:Name="TxtCsvPath" Classes="muted"
                         Text="No file selected" TextWrapping="Wrap"/>
              <Button x:Name="BtnChooseCsv"
                      Classes="outline" Content="Chooseâ€¦"
                      Width="160"
                      HorizontalAlignment="Left"
                      Click="BtnChooseCsv_OnClick"/>
            </StackPanel>
          </Border>
        </Grid>

        <!-- Footer name + Generate -->
        <Border Grid.Row="4" Classes="card" Padding="14">
          <Grid ColumnDefinitions="Auto,Auto" ColumnSpacing="12" VerticalAlignment="Center">
            <!-- Footer name -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
              <TextBlock Text="Signature name:" Classes="muted" VerticalAlignment="Center"/>
              <TextBox x:Name="TbFooterName"
                       Width="200"
                       Watermark="e.g. NewSignature"
                       VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Generate -->
            <Button Grid.Column="1"
                    x:Name="BtnGenerate"
                    Classes="primary"
                    Content="Generate Signatures"
                    MinWidth="180"
                    Height="42"
                    VerticalAlignment="Center"
                    Click="BtnGenerate_OnClick"/>
          </Grid>
        </Border>

        <!-- Log (fills the rest) -->
        <Border Grid.Row="6" Classes="card" Padding="14">
          <Grid RowDefinitions="Auto,8,Auto,*">
            <ProgressBar x:Name="Progress" Minimum="0" Maximum="100" Value="0" IsVisible="False"/>
            <TextBlock Grid.Row="2" Text="Log" FontWeight="SemiBold" Classes="muted" Margin="0,0,0,8"/>
            <ScrollViewer Grid.Row="3">
              <ItemsControl x:Name="LogList">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding}" Classes="muted"/>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </ScrollViewer>
          </Grid>
        </Border>
      </Grid>

      <!-- RIGHT COLUMN -->
      <Border Grid.Column="1" Classes="card" Padding="20" VerticalAlignment="Stretch">
        <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto" RowSpacing="12">

          <!-- Title -->
          <TextBlock Text="Delivery Method" FontSize="18" FontWeight="Bold"/>

          <!-- Mode -->
          <Grid Grid.Row="1" ColumnDefinitions="Auto,Auto" ColumnSpacing="22">
            <RadioButton x:Name="RbSendEmails"
                         Content="Send by Email"
                         IsChecked="True"
                         GroupName="DeliveryMode"/>
            <RadioButton x:Name="RbDownloadZip"
                         Grid.Column="1"
                         Content="Download ZIP"
                         GroupName="DeliveryMode"/>
          </Grid>

          <!-- Subject -->
          <StackPanel Grid.Row="2" Spacing="6"
                      IsEnabled="{Binding #RbSendEmails.IsChecked}">
            <TextBlock Text="Subject" Classes="muted"/>
            <TextBox x:Name="TbSubject" Watermark="Subject" Text="New Email Signature"/>
          </StackPanel>

          <!-- Body -->
          <StackPanel Grid.Row="3" Spacing="6"
                      IsEnabled="{Binding #RbSendEmails.IsChecked}">
            <TextBlock Text="Message Body" Classes="muted"/>
            <TextBox x:Name="TbBody"
                     AcceptsReturn="True"
                     MinHeight="120" MaxHeight="160"
                     Text="Hi,&#10;&#10;Attached you will find your personalized email signature (HTML).&#10;&#10;Best regards,&#10;IT Team"/>
          </StackPanel>

          <!-- Manual PDF (non-clickable field + browse) -->
          <Grid Grid.Row="4" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10"
                IsEnabled="{Binding #RbSendEmails.IsChecked}">
            <CheckBox x:Name="ChkAttachManual"
                      Content="Attach manual (PDF)"
                      VerticalAlignment="Center"
                      IsChecked="False"/>
            <TextBox Grid.Column="1"
                     x:Name="TbManualPath"
                     Watermark="No file selected"
                     IsReadOnly="True"
                     IsHitTestVisible="False"
                     Focusable="False"
                     IsTabStop="False"
                     MaxLines="1"/>
            <Button Grid.Column="2"
                    x:Name="BtnBrowseManual"
                    Classes="outline"
                    Content="Browseâ€¦"
                    MinWidth="110"
                    IsEnabled="{Binding #ChkAttachManual.IsChecked}"
                    Click="BtnChooseManual_OnClick"/>
          </Grid>

          <!-- SMTP settings -->
          <Border Grid.Row="5"
                  Background="#F8FAFF" BorderBrush="#E0E6F0" BorderThickness="1"
                  CornerRadius="10" Padding="12"
                  IsEnabled="{Binding #RbSendEmails.IsChecked}">
            <StackPanel Spacing="10">
              <TextBlock Text="SMTP Settings" FontWeight="SemiBold"/>

              <Grid ColumnDefinitions="*,*,*,*" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="8">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="SMTP Host" Classes="muted" VerticalAlignment="Center"/>
                <TextBox   Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3"
                           x:Name="TbSmtpHost" Watermark="smtp.company.com" Text="smtp.office365.com"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Port" Classes="muted" VerticalAlignment="Center"/>
                <NumericUpDown Grid.Row="1" Grid.Column="1"
                               x:Name="NumSmtpPort" Minimum="1" Maximum="65535" Value="587"/>
                <TextBlock Grid.Row="1" Grid.Column="2" Text="SSL/TLS" Classes="muted" VerticalAlignment="Center"/>
                <ToggleSwitch Grid.Row="1" Grid.Column="3" x:Name="TgUseSsl" IsChecked="False" HorizontalAlignment="Left"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Username" Classes="muted" VerticalAlignment="Center"/>
                <TextBox   Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3"
                           x:Name="TbSmtpUser" Watermark="login@company.com"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Password" Classes="muted" VerticalAlignment="Center"/>
                <TextBox   Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3"
                           x:Name="TbSmtpPassword" Watermark="Password"/>
              </Grid>

              <!-- Hint + test button -->
              <Grid ColumnDefinitions="*,Auto">
                <TextBlock Text="Test Connection" Classes="muted" VerticalAlignment="Center"/>
                <Button Grid.Column="1" x:Name="BtnTestSmtp"
                        Classes="outline"
                        Content="Test SMTP"
                        MinWidth="120" Height="34"
                        Click="BtnTestSmtp_OnClick"/>
              </Grid>
            </StackPanel>
          </Border>

          <!-- Send emails button -->
          <Grid Grid.Row="6" ColumnDefinitions="*,Auto" Margin="0,8,0,0" VerticalAlignment="Bottom">
            <TextBlock x:Name="TxtActionHint"
                       Text="Each recipient will receive their own HTML file."
                       Classes="muted" VerticalAlignment="Center"
                       MaxWidth="520" TextWrapping="Wrap"/>
            <Button Grid.Column="1" x:Name="BtnRun"
                    Classes="primary" Content="Send Emails"
                    MinWidth="180"
                    Click="BtnRun_OnClick"/>
          </Grid>
        </Grid>
      </Border>
    </Grid>
  </Grid>
</Window>
